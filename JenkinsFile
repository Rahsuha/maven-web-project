pipeline{
agent any

tools{
maven 'maven-3.8.4'
jdk 'jdk-11'
}

environment{
	SONAR_RUNNER_HOME = 
}
stages{
stage("Clean") {
  steps{
      echo "Start Clean"
      bat "mvn clean"
  }
}
stage("Test"){
steps{
  echo "Start Test"
  bat "mvn test"
}
}
stage("Build"){
steps{
  echo "Start build"
  bat "mvn install -DskipTests"
}
}

stage("Sonar Scan"){
	steps{
		withSonarQubeEnv(credentialsId: 'Sonar-jenkins-token', installationName: 'Sonarqube') {
			bat "sonar-scanner
-Dsonar.projectKey=maven-project-jenkins-lab
-Dsonar.projectName=maven-project-jenkins-lab
-Dsonar.sources=src/main
-Dsonar.sourceEncoding=UTF-8
-Dsonar.language=jav
-Dsonar.test=src/test
-Dsonar.junit.reportsPath=target/surefire-reports
-Dsonar.surefire.reportsPath=target/surefire-reports
-Dsonar.jacoco.reportPath=target/jacoco.exec
-Dsonar.java.binaries=target/classes
-Dsonar.java.coveragePlugin=jacoco
"
		}
	}
}
}
}
